# 漸進式壓力測試說明

##  測試目的

這個測試會逐步增加系統負載，從小負載開始直到找到系統極限，並生成視覺化圖表展示系統性能變化趨勢。

##  執行測試

\\\powershell
# 方式1：執行單一測試
mvn test -Dtest=ProgressiveStressTest

# 方式2：執行所有壓力測試
mvn test -Dtest=*StressTest
\\\

##  測試流程

1. **起始負載**: 從10個併發用戶開始
2. **逐步增加**: 每輪增加10個併發用戶
3. **記錄數據**: 每輪記錄響應時間、錯誤率、吞吐量
4. **停止條件**: 
   - 錯誤率超過20%，或
   - P95響應時間超過5秒，或
   - 達到最大併發數200

##  輸出報告

測試完成後會在 \	arget/stress-test-reports/\ 目錄生成：

### 圖表文件
- \performance-chart.png\ - 響應時間趨勢（P50/P95/P99）
- \error-rate-chart.png\ - 錯誤率趨勢
- \	hroughput-chart.png\ - 吞吐量趨勢

### 數據文件
- \	est-results.csv\ - 原始測試數據（可用Excel或其他工具分析）

##  輸出示例

### 控制台輸出
\\\
================================================================================
PST-01: 漸進式登入壓力測試 - 尋找系統極限
================================================================================

測試配置：
  起始併發數: 10
  每輪增加: 10
  最大併發數: 200
  停止條件: 錯誤率>20% 或 P95>5000ms


第 1 輪測試 - 併發數: 10


測試結果：
  併發數=10, 成功=10, 失敗=0, 錯誤率=0.00%, 
  響應時間(ms): Min=45, P50=67, P95=123, P99=145, Max=156, Avg=78.50, 
  吞吐量=12.34 req/s


第 2 輪測試 - 併發數: 20
━

測試結果：
  併發數=20, 成功=20, 失敗=0, 錯誤率=0.00%, 
  響應時間(ms): Min=67, P50=145, P95=234, P99=267, Max=289, Avg=156.25, 
  吞吐量=23.45 req/s

...

  系統達到極限：P95響應時間 5234ms 超過閾值 5000ms

================================================================================
測試完成總結
================================================================================
總測試輪數: 8
系統極限: 已達到

最佳性能點：
  併發數=70, 成功=70, 失敗=0, 錯誤率=0.00%, 
  響應時間(ms): Min=234, P50=678, P95=1234, P99=1456, Max=1678, Avg=789.45, 
  吞吐量=45.67 req/s

 測試報告已生成：
   圖表: E:\\...\\target\\stress-test-reports\\performance-chart.png
   數據: E:\\...\\target\\stress-test-reports\\test-results.csv
\\\

##  CSV 數據格式

\\\csv
併發數,成功數,失敗數,錯誤率(%),Min(ms),P50(ms),P95(ms),P99(ms),Max(ms),Avg(ms),吞吐量(req/s)
10,10,0,0.00,45,67,123,145,156,78.50,12.34
20,20,0,0.00,67,145,234,267,289,156.25,23.45
30,30,0,0.00,123,234,456,567,678,289.50,34.56
...
\\\

##  如何解讀結果

### 響應時間趨勢圖
- **綠線 (P50)**: 大部分用戶體驗的響應時間
- **橘線 (P95)**: 5%最慢請求的響應時間
- **紅線 (P99)**: 1%最慢請求的響應時間

 **理想情況**: 線條平穩上升
 **警告信號**: 線條突然陡升（系統開始吃力）

### 錯誤率趨勢圖
- 錯誤率應保持在0-5%以內
- 錯誤率突然上升 = 系統過載

### 吞吐量趨勢圖
- 吞吐量應隨併發數增加而增加
- 吞吐量開始下降 = 系統瓶頸出現

##  自定義配置

修改 \ProgressiveStressTest.java\ 中的配置：

\\\java
int startConcurrency = 10;      // 起始併發數
int incrementStep = 10;         // 每輪增加數量
int maxConcurrency = 200;       // 最大併發數
double maxErrorRate = 20.0;     // 最大錯誤率閾值
long maxP95ResponseTime = 5000; // 最大P95響應時間閾值
\\\

##  建議

1. **首次測試**: 使用默認配置，了解系統基本能力
2. **調優後**: 增加 \maxConcurrency\ 看能否承受更多負載
3. **生產環境**: 建議使用 JMeter 或 K6 進行更大規模測試
4. **持續監控**: 定期執行測試，追蹤系統性能變化

##  依賴

測試使用 JFreeChart 生成圖表，已在 \pom.xml\ 中配置：

\\\xml
<dependency>
    <groupId>org.jfree</groupId>
    <artifactId>jfreechart</artifactId>
    <version>1.5.4</version>
    <scope>test</scope>
</dependency>
\\\

##  測試覆蓋範圍

目前測試場景：
-  登入API併發壓力測試

未來可擴展：
-  聊天訊息發送壓力測試
-  提案創建壓力測試
-  搜索查詢壓力測試
