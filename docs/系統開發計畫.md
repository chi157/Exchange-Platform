📋 系統開發計畫（依照優先級與依賴關係）
🏗️ 第一階段：基礎建設 (Foundation)

這是所有功能的基礎，必須先完成：

🔧 配置與資料庫連線

application.yml 設定 MySQL 連線

設定 Flyway migration

建立基礎 Entity 類別：

BaseEntity：id, createdAt, updatedAt

AuditableEntity：createdBy, updatedBy

🗂️ 資料庫 Schema (Flyway Migrations)
版本	檔案名稱	說明
V1	create_users_table.sql	使用者資料表
V2	create_listings_table.sql	上架資料表
V3	create_proposals_tables.sql	提案資料表
V4	create_swaps_tables.sql	交換資料表
V5	create_shipments_tables.sql	出貨資料表
V6	create_reviews_disputes_tables.sql	評價與爭議
V7	create_messages_table.sql	訊息記錄表
⚙️ 例外處理架構

自訂例外類別（CustomException）

全域例外處理器（GlobalExceptionHandler）

🎯 第二階段：核心領域模型 (Domain Layer)

依據 Object Design Document 建立下列：

🧩 JPA Entity 類別（依賴順序）

User

Listing

Proposal, ProposalItem

Swap

Shipment, ShipmentEvent

Message, Review, Dispute

🗃️ Repository 介面

為每個 Entity 建立對應的 Repository

🔐 第三階段：安全與認證 (Security)

對應 UC-01: Authentication

🔒 Spring Security 設定

SecurityConfig

UserDetailsService 實作

使用 BCrypt 密碼編碼

👤 Auth Controller & Service

登入 / 登出

註冊

Session 管理

💱 第四階段：核心交易流程 (Core Transaction Flow)

主要商業邏輯鏈路：上架 → 搜尋 → 提案 → 協商 → 交換

UC-02：Listing Management（上架管理）

ListingService, ListingController

功能：上架 / 編輯 / 刪除

圖片上傳處理

UC-03：Search & Filter（搜尋與過濾）

搜尋 Service（使用 Specification 動態查詢）

過濾條件：idol_group, member_name, condition 等

UC-04：Proposal（交換提案）

ProposalService, ProposalController

功能：建立提案、鎖定 Listing

加入提案過期機制（排程任務）

UC-05：Negotiation Chat（協商聊天）

設定 WebSocket

ChatService, ChatWebSocketController

訊息儲存與檢索

UC-06：Exchange Confirmation & Shipping（確認交換與出貨）

SwapService, SwapController

接受提案 → 建立 Swap

初始化出貨（Shipment）

UC-07：Manual Tracking（手動物流追蹤）

ShipmentService, ShipmentController

手動更新物流狀態

產生追蹤連結

UC-08：Delivery Confirmation（收貨確認）

雙方確認收貨邏輯

Swap 狀態轉為 COMPLETED

⭐ 第五階段：信譽與爭議處理 (Trust & Resolution)
UC-09：Review & Reputation（評價與信譽）

ReviewService, ReviewController

評分計算與統計

UC-10：Dispute & Arbitration（爭議仲裁）

DisputeService, DisputeController

管理員仲裁功能

🚀 第六階段：進階功能 (Advanced Features)
編號	功能	說明
UC-11	Favorites & Follow	收藏與追蹤
UC-12	Blacklist & Risk Management	黑名單與風險管理
UC-13	Condition Grading	品相評級
UC-14	Auto Matching	自動配對
UC-15	Themed Market	主題市集
🔔 第七階段：管理後台與通知 (Admin & Notifications)
🧭 Admin Panel

上架審核

黑名單管理

爭議處理

📫 Notification System

Email 通知

站內通知

✅ 第八階段：測試與優化 (Testing & Optimization)

單元測試（Service 層）

整合測試（Controller + Repository）

效能優化（查詢優化、快取機制）